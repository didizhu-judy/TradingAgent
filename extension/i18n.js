/**
 * 中英文文案，与 chrome.storage.local.language 配合使用
 */
const T = {
  zh: {
    title: 'T212 Agent',
    refresh: '刷新',
    tab_overview: '总览',
    tab_positions: '持仓',
    tab_cash: '现金',
    tab_more: '更多',
    overview_title: '账户总览',
    positions_title: '持仓',
    watchlist_title: '自选',
    quote_title: '行情查询',
    cash_title: '现金',
    more_title: '更多',
    open_sidebar: '在侧边栏打开',
    open_floating: '在页面打开悬浮窗',
    open_options: '选项与 API 配置',
    settings: '设置',
    skin: '皮肤',
    skin_code: '代码台',
    skin_doc: '文档台',
    skin_sheet: '表格台',
    skin_slides: '演示台',
    skin_mail: '邮件台',
    skin_bi: '报表台',
    skin_desc_code: '编辑器式密集布局',
    skin_desc_doc: '文档阅读式布局',
    skin_desc_sheet: '网格式紧凑布局',
    skin_desc_slides: '演示卡片式布局',
    skin_desc_mail: '收件箱信息流布局',
    skin_desc_bi: '仪表盘数据卡布局',
    vscode_menu_file: '文件',
    vscode_menu_edit: '编辑',
    vscode_menu_view: '视图',
    vscode_menu_go: '跳转',
    vscode_menu_run: '运行',
    vscode_menu_terminal: '终端',
    vscode_menu_help: '帮助',
    slides_thumb_overview: '总览页',
    slides_thumb_pnl: '盈亏页',
    slides_thumb_cash: '现金页',
    slides_thumb_positions: '持仓页',
    slides_scene_title_pnl: '盈亏快照',
    slides_scene_title_cash: '现金焦点',
    slides_scene_title_positions: '持仓焦点',
    more_hint: '数据仅存本机，不上传。遇 CORS 可在选项中启用本地代理。',
    appearance: '外观',
    background_opacity: '背景透明度',
    back_positions: '返回持仓',
    sort_value: '按市值',
    sort_pl: '按盈亏',
    sort_name: '按名称',
    last_updated: '最后更新',
    auto_refresh_in: 's 后自动刷新',
    empty_hint: '请在',
    empty_options: '选项',
    empty_suffix: '中配置 API Key 和 API Secret',
    guide_title: '首次使用指引',
    guide_step_api: '进入设置页 API 区域，填写 Trading 212 的 API Key / API Secret 并保存。',
    guide_step_skin: '在顶部点击「皮肤」可切换职业场景模板（代码台/文档台/表格台等）。',
    guide_step_sidebar: '在总览页右下角点击 Open in sidebar，可固定在侧边栏查看实时数据。',
    guide_step_watchlist: '打开 Watchlist 页面，可搜索股票并加入自选；列表会自动刷新价格。',
    no_positions: '暂无持仓',
    no_watchlist: '暂无自选',
    watchlist_api_error: '自选接口不可用：',
    loading: '加载中…',
    retry: '重试',
    error_floating: '请在普通网页中打开悬浮窗（当前页不支持）',
    error_rate_limit: '请求过于频繁，请 %s 秒后再试',
    label_total_value: '总资产',
    label_available_cash: '可用现金',
    label_investments_value: '投资市值',
    label_unrealized_pl: '未实现盈亏',
    label_realized_pl: '已实现盈亏',
    label_available_to_trade: '可用交易',
    label_blocked: '冻结',
    label_free: '自由现金',
    label_invested: '投资中',
    label_payout: '红利',
    no_cash_data: '暂无现金数据',
    label_qty: '数量',
    label_ticker: '代码',
    label_price: '现价',
    label_change: '涨跌',
    label_cost: '成本',
    label_avg_cost: '成本均价',
    label_value: '市值',
    label_total_cost: '总成本',
    theme_switch_dark: '切换到夜间模式',
    theme_switch_light: '切换到日间模式',
    watchlist: '自选',
    quote: '行情',
    quote_input_label: '股票代码',
    quote_input_placeholder: '如 MP / AAPL / MP_US_EQ',
    quote_search: '查询',
    quote_searching: '查询中…',
    quote_hint: '支持输入简写代码；若有歧义可输入完整 ticker（如 AAPL_US_EQ）。',
    watchlist_search_hint: '输入股票代码查询，若不在自选中可直接加入。',
    watchlist_add: '加入自选',
    watchlist_in_list: '已在自选中',
    trade_buy: '买入下单',
    trade_title: '交易',
    trade_available_qty: '可卖数量',
    trade_side: '方向',
    order_side_buy: '买入',
    order_side_sell: '卖出',
    trade_order_type: '订单类型',
    order_type_market: '市价单',
    order_type_limit: '限价单',
    order_type_stop: '止损单',
    order_type_stop_limit: '止损限价单',
    trade_quantity: '数量',
    trade_limit_price: '限价',
    trade_stop_price: '止损触发价',
    trade_time_validity: '有效期',
    trade_extended_hours: '盘前盘后',
    order_submit: '提交订单',
    order_submitting: '提交中…',
    order_confirm_title: '请确认订单',
    order_confirm_cancel: '取消',
    order_confirm_submit: '确认下单',
    pending_orders_title: '未成交订单',
    pending_orders_empty: '当前标的暂无未成交订单',
    pending_orders_loading: '挂单加载中…',
    pending_cancel: '撤单',
    trade_error_no_ticker: '缺少交易标的代码',
    trade_error_quantity: '数量必须大于 0',
    trade_error_sell_exceeds: '卖出数量不能超过持仓（最多 %s）',
    trade_error_limit_price: '限价必须大于 0',
    trade_error_stop_price: '止损触发价必须大于 0',
    trade_error_sell_conflict: '该标的已有未成交卖单，请先撤单再提交',
    trade_submit_success: '下单已提交，订单号 %s',
    trade_submit_success_no_id: '下单已提交',
    trade_submit_failed: '下单失败',
    pending_cancel_success: '撤单成功，订单号 %s',
    pending_cancel_failed: '撤单失败',
    pending_load_error: '挂单加载失败',
    yes: '是',
    no: '否',
    analysis: '分析',
    analysis_title: 'AI 行情分析',
    analysis_module_copy: '模块 A：复制 Prompt',
    analysis_module_generate: '模块 B：直接生成结果',
    analysis_primary_hint: '推荐在 MiroMind 中分析：一键复制持仓总结并打开 MiroMind，粘贴即可。无需配置、不消耗额度。',
    analysis_secondary_divider: '或在扩展内生成（需配置 OpenRouter）',
    analysis_hint: '结合当前持仓，生成今日行情解读与操作建议（需在选项中配置 OpenRouter API Key）',
    analysis_generate: '生成分析',
    analysis_generate_in_extension: '在扩展内生成分析',
    analysis_loading: '分析生成中…',
    analysis_error: '分析失败',
    analysis_no_key: '请在选项中配置 OpenRouter API Key',
    analysis_model_label: '分析模型',
    analysis_lang_label: '输出语言',
    analysis_lang_follow: '跟随扩展设置',
    analysis_prompt_label: '分析 Prompt',
    analysis_prompt_reset: '重置 Prompt',
    analysis_copy_prompt: '复制 Prompt',
    analysis_prompt_copied: 'Prompt 已复制',
    analysis_prompt_editable: '当前为 OpenRouter 模式，可直接编辑 Prompt。',
    analysis_prompt_readonly: '当前为自定义 API 模式，Prompt 仅展示不可编辑。',
    analysis_open_miromind: '打开 MiroMind',
    analysis_open_chatgpt: '打开 ChatGPT',
    analysis_open_perplexity: '打开 Perplexity',
    analysis_miromind_hint: '用 MiroMind 分析：生成一条提示词并复制到剪贴板，点击后打开 MiroMind，在输入框粘贴 (Ctrl+V) 即可。',
    analysis_copy_open_miromind: '复制 Prompt 并打开 MiroMind',
    analysis_copied_open: '已复制，请在 MiroMind 中粘贴 (Ctrl+V)',
    back_main: '返回',
    back_watchlist: '返回自选'
  },
  en: {
    title: 'T212 Agent',
    refresh: 'Refresh',
    tab_overview: 'Overview',
    tab_positions: 'Positions',
    tab_cash: 'Cash',
    tab_more: 'More',
    overview_title: 'Account Overview',
    positions_title: 'Positions',
    watchlist_title: 'Watchlist',
    quote_title: 'Quote Lookup',
    cash_title: 'Cash',
    more_title: 'More',
    open_sidebar: 'Open in Side Panel',
    open_floating: 'Open Floating Panel',
    open_options: 'Options & API',
    settings: 'Settings',
    skin: 'Skin',
    skin_code: 'Code Desk',
    skin_doc: 'Document Desk',
    skin_sheet: 'Sheet Desk',
    skin_slides: 'Slides Desk',
    skin_mail: 'Mail Desk',
    skin_bi: 'BI Desk',
    skin_desc_code: 'Editor-like compact layout',
    skin_desc_doc: 'Document reading layout',
    skin_desc_sheet: 'Grid compact layout',
    skin_desc_slides: 'Deck card layout',
    skin_desc_mail: 'Inbox flow layout',
    skin_desc_bi: 'Dashboard card layout',
    vscode_menu_file: 'File',
    vscode_menu_edit: 'Edit',
    vscode_menu_view: 'View',
    vscode_menu_go: 'Go',
    vscode_menu_run: 'Run',
    vscode_menu_terminal: 'Terminal',
    vscode_menu_help: 'Help',
    slides_thumb_overview: 'Overview',
    slides_thumb_pnl: 'P&L',
    slides_thumb_cash: 'Cash',
    slides_thumb_positions: 'Positions',
    slides_scene_title_pnl: 'P&L Snapshot',
    slides_scene_title_cash: 'Cash Focus',
    slides_scene_title_positions: 'Position Focus',
    more_hint: 'Data stays on your device. Use proxy in options if CORS occurs.',
    appearance: 'Appearance',
    background_opacity: 'Background opacity',
    back_positions: 'Back to Positions',
    sort_value: 'By Value',
    sort_pl: 'By P&L',
    sort_name: 'By Name',
    last_updated: 'Last updated',
    auto_refresh_in: 's until refresh',
    empty_hint: 'Please configure API in',
    empty_options: 'Options',
    empty_suffix: '',
    guide_title: 'First-Time Guide',
    guide_step_api: 'Open Options and fill your Trading 212 API Key / API Secret in the API section, then save.',
    guide_step_skin: 'Use the top Skin button to switch workplace templates (code/doc/sheet/etc.).',
    guide_step_sidebar: 'Use Open in Side Panel at the lower-right corner of Overview to pin real-time data.',
    guide_step_watchlist: 'Open Watchlist to search symbols and add them; prices refresh automatically.',
    no_positions: 'No positions',
    no_watchlist: 'No watchlist items',
    watchlist_api_error: 'Watchlist API unavailable: ',
    loading: 'Loading…',
    retry: 'Retry',
    error_floating: 'Open a normal webpage first to use floating panel.',
    error_rate_limit: 'Too many requests. Try again in %s seconds.',
    label_total_value: 'Total value',
    label_available_cash: 'Available cash',
    label_investments_value: 'Investments value',
    label_unrealized_pl: 'Unrealized P&L',
    label_realized_pl: 'Realized P&L',
    label_available_to_trade: 'Available to trade',
    label_blocked: 'Blocked',
    label_free: 'Free',
    label_invested: 'Invested',
    label_payout: 'Payout',
    no_cash_data: 'No cash data',
    label_qty: 'Qty',
    label_ticker: 'Ticker',
    label_price: 'Price',
    label_change: 'Change',
    label_cost: 'Cost',
    label_avg_cost: 'Avg cost',
    label_value: 'Value',
    label_total_cost: 'Total cost',
    theme_switch_dark: 'Switch to dark mode',
    theme_switch_light: 'Switch to light mode',
    watchlist: 'Watchlist',
    quote: 'Quote',
    quote_input_label: 'Ticker',
    quote_input_placeholder: 'e.g. MP / AAPL / MP_US_EQ',
    quote_search: 'Search',
    quote_searching: 'Searching…',
    quote_hint: 'Short symbols are supported; use full ticker for ambiguity (e.g. AAPL_US_EQ).',
    watchlist_search_hint: 'Search a ticker and add it if it is not in your watchlist.',
    watchlist_add: 'Add to watchlist',
    watchlist_in_list: 'Already in watchlist',
    trade_buy: 'Buy',
    trade_title: 'Trade',
    trade_available_qty: 'Available to sell',
    trade_side: 'Side',
    order_side_buy: 'Buy',
    order_side_sell: 'Sell',
    trade_order_type: 'Order type',
    order_type_market: 'Market',
    order_type_limit: 'Limit',
    order_type_stop: 'Stop',
    order_type_stop_limit: 'Stop-Limit',
    trade_quantity: 'Quantity',
    trade_limit_price: 'Limit price',
    trade_stop_price: 'Stop price',
    trade_time_validity: 'Time validity',
    trade_extended_hours: 'Extended hours',
    order_submit: 'Submit order',
    order_submitting: 'Submitting…',
    order_confirm_title: 'Confirm order',
    order_confirm_cancel: 'Cancel',
    order_confirm_submit: 'Place order',
    pending_orders_title: 'Pending orders',
    pending_orders_empty: 'No pending orders for this ticker',
    pending_orders_loading: 'Loading pending orders…',
    pending_cancel: 'Cancel order',
    trade_error_no_ticker: 'Missing ticker',
    trade_error_quantity: 'Quantity must be greater than 0',
    trade_error_sell_exceeds: 'Sell quantity exceeds position (max %s)',
    trade_error_limit_price: 'Limit price must be greater than 0',
    trade_error_stop_price: 'Stop price must be greater than 0',
    trade_error_sell_conflict: 'A pending sell order already exists for this ticker. Cancel it first.',
    trade_submit_success: 'Order submitted. ID %s',
    trade_submit_success_no_id: 'Order submitted.',
    trade_submit_failed: 'Order failed',
    pending_cancel_success: 'Order cancelled. ID %s',
    pending_cancel_failed: 'Cancel failed',
    pending_load_error: 'Failed to load pending orders',
    yes: 'Yes',
    no: 'No',
    analysis: 'Analysis',
    analysis_title: 'AI Market Analysis',
    analysis_module_copy: 'Module A: Copy Prompt',
    analysis_module_generate: 'Module B: Generate Result',
    analysis_primary_hint: 'Recommended: analyze in MiroMind. Copy your portfolio summary and open MiroMind, then paste. No config or cost.',
    analysis_secondary_divider: 'Or generate in extension (requires OpenRouter)',
    analysis_hint: 'Generate today\'s market view and action suggestions from your positions (configure OpenRouter API Key in Options)',
    analysis_generate: 'Generate',
    analysis_generate_in_extension: 'Generate in extension',
    analysis_loading: 'Generating…',
    analysis_error: 'Analysis failed',
    analysis_no_key: 'Configure OpenRouter API Key in Options',
    analysis_model_label: 'Model',
    analysis_lang_label: 'Output language',
    analysis_lang_follow: 'Same as extension',
    analysis_prompt_label: 'Analysis Prompt',
    analysis_prompt_reset: 'Reset prompt',
    analysis_copy_prompt: 'Copy prompt',
    analysis_prompt_copied: 'Prompt copied',
    analysis_prompt_editable: 'OpenRouter mode: prompt is editable.',
    analysis_prompt_readonly: 'Custom API mode: prompt is display-only.',
    analysis_open_miromind: 'Open MiroMind',
    analysis_open_chatgpt: 'Open ChatGPT',
    analysis_open_perplexity: 'Open Perplexity',
    analysis_miromind_hint: 'Use MiroMind: copy a prompt to clipboard and open MiroMind; paste (Ctrl+V) in the input box.',
    analysis_copy_open_miromind: 'Copy prompt & open MiroMind',
    analysis_copied_open: 'Copied. Paste (Ctrl+V) in MiroMind',
    back_main: 'Back',
    back_watchlist: 'Back to Watchlist'
  }
};

export function t(lang, key) {
  const L = T[lang === 'en' ? 'en' : 'zh'];
  return L[key] != null ? L[key] : (T.zh[key] || key);
}

export async function getLang() {
  const r = await chrome.storage.local.get('language');
  return r.language === 'en' ? 'en' : 'zh';
}
